window.onload=function(){var g=window.Cropper;var e=window.URL||window.webkitURL;var k=document.querySelector(".img-container");var l=k.getElementsByTagName("img").item(0);var c=document.getElementById("actions");var h={aspectRatio:tyle,viewMode:vmode,preview:".img-preview",autoCrop:true,strict:true,background:true,autoCropArea:1};var j=new g(l,h);var a=l.src;var i="image/jpeg";var d;if(!document.createElement("canvas").getContext){$('button[data-method="getCroppedCanvas"]').prop("disabled",true)}if(typeof document.createElement("cropper").style.transition==="undefined"){$('button[data-method="rotate"]').prop("disabled",true);$('button[data-method="scale"]').prop("disabled",true)}c.querySelector(".docs-buttons").onclick=function(n){var r=n||window.event;var q=r.target||r.srcElement;var p;var b;var m;var o;if(!j){return}while(q!==this){if(q.getAttribute("data-method")){break}q=q.parentNode}if(q===this||q.disabled||q.className.indexOf("disabled")>-1){return}o={method:q.getAttribute("data-method"),target:q.getAttribute("data-target"),option:q.getAttribute("data-option")||undefined,secondOption:q.getAttribute("data-second-option")||undefined};p=j.cropped;if(o.method){if(typeof o.target!=="undefined"){m=document.querySelector(o.target);if(!q.hasAttribute("data-option")&&o.target&&m){try{o.option=JSON.parse(m.value)}catch(r){console.log(r.message)}}}switch(o.method){case"rotate":if(p){j.clear()}break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(r){console.log(r.message)}if(i==="image/jpeg"){if(!o.option){o.option={}}o.option.fillColor="#fff"}break}b=j[o.method](o.option,o.secondOption);switch(o.method){case"rotate":if(p){j.crop()}break;case"scaleX":case"scaleY":q.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":if(b){b.toBlob(function(s){var t=e.createObjectURL(s);$("#Cimg").attr("src",t)},"image/jpeg",1);$("#tad-taoanh").removeClass("disabled")}break;case"destroy":j=null;if(d){e.revokeObjectURL(d);d="";l.src=a}break}if(typeof b==="object"&&b!==j&&m){try{m.value=JSON.stringify(b)}catch(r){console.log(r.message)}}}};document.body.onkeydown=function(b){var m=b||window.event;if(!j||this.scrollTop>300){return}switch(m.keyCode){case 37:m.preventDefault();j.move(-1,0);break;case 38:m.preventDefault();j.move(0,-1);break;case 39:m.preventDefault();j.move(1,0);break;case 40:m.preventDefault();j.move(0,1);break}};$(".cropanh-container").hide();var f=document.getElementById("inputImage");if(e){f.onchange=function(){var m=this.files;var b;if(j&&m&&m.length){b=m[0];if(/^image\/\w+/.test(b.type)){i=b.type;if(d){e.revokeObjectURL(d)}l.src=d=e.createObjectURL(b);j.destroy();j=new g(l,h);f.value=null;$(".cropanh").val(1);$(".cropanh-container").show();$(".btn-upanh span,.btn-chonanh").html("<i class='fas fa-upload'></i> Chọn ảnh khác")}else{window.alert("Vui lòng chọn một tệp hình ảnh.")}}}}else{f.disabled=true;f.parentNode.className+=" disabled"}};