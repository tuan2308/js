<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link as='style' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css'
        media='all' rel='stylesheet' />

    <script crossorigin='anonymous'
        integrity='sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=='
        src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js'></script>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" media="all">

</head>

<body class="col-md-9">
    <link rel='stylesheet' href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-colorpicker/2.5.3/css/bootstrap-colorpicker.min.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-colorpicker/2.5.3/js/bootstrap-colorpicker.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" integrity="sha512-0SPWAwpC/17yYyZ/4HSllgaK7/gg9OlVozq8K7rf3J8LvCjYEEIfzzpnA2/SSjpGIunCSD18r3UhvDcu/xncWA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <script src="../testcr.js" type="text/javascript"></script>
    <script src="https://cdn.taoanhdep.com/tad/tv/tad-crop-png1.js" type="text/javascript"></script>


    <style>.xulyhinhanh img{margin:0!important}.chonanh-avt{width:38px;height:38px;float:left;border:1px solid #ddd;border-radius:5px;overflow:hidden;margin-right:10px}.img-preview{width:36px;height:36px;background:url(//2.bp.blogspot.com/-ZTMZs1MahXE/XqZq3WgQKDI/AAAAAAAAdRI/ib4MFhw49m82VLY9b2LzZBw5w3tItLSrQCK4BGAYYCw/s36/thumbnail-man.png) no-repeat center;background-size:36px}#chonanhModal{display:block!important}#chonanhModal:not(.show){opacity:0;visibility:hidden}.img-container,.img-preview{background-color:#f7f7f7;text-align:center;width:100%}.img-container{margin-bottom:1rem;max-height:300px;min-height:280px}.img-container>img{max-width:100%}.img-preview{margin:auto!important;margin-bottom:.5rem;margin-right:.5rem;overflow:hidden}.img-preview>img{max-width:100%}
    
    
/*     
   #temp{position:fixed;height:0;top:0;left:0;overflow:hidden}  */
    
    </style>

    <label><b>Upload ảnh*</b></label>
    <div class="xulyhinhanh mb-2">
    <div class="chonanh-avt">
        <div class="img-preview" style="width: 36px; height: 36px;"><img crossorigin="anonymous" src="https://1.bp.blogspot.com/-z3RZ2G93tVo/YHES6yUdnzI/AAAAAAAArsw/Jq_pD24Pn-sEW-XwzGl18qlgIYQZZOeqgCNcBGAsYHQ/s0/blank.png?timestamp=1629977090487" alt="Tạo ảnh đẹp" style="display: block; width: 100px; height: 100px; min-width: 0px !important; min-height: 0px !important; max-width: none !important; max-height: none !important; transform: none;"></div>
        </div>
        <button type="button" class="btn btn-primary btn-chonanh" data-toggle="modal" data-target="#chonanhModal">
            <i class="fas fa-upload"></i> Chọn ảnh
            </button>
            <div class="modal fade" id="chonanhModal" tabindex="-1" role="dialog" aria-labelledby="chonanhModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="chonanhModalLabel">Chọn ảnh từ thiết bị</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&#215;</span>
                </button>
                </div>
                <div class="modal-body">
                <div id="actions">
                <div class="docs-buttons">
                <label class="btn btn-primary btn-upload btn-upanh" for="inputImage" title="Upload image file">
                <input type="file" class="sr-only" id="inputImage" name="file" accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff">
                <span><i class="fas fa-upload"></i> Chọn ảnh</span>
                </label>
                <div class="cropanh-container mt-2" style="display:none">
                <div class="img-container">
                <img alt="Tạo ảnh đẹp" src="https://1.bp.blogspot.com/-z3RZ2G93tVo/YHES6yUdnzI/AAAAAAAArsw/Jq_pD24Pn-sEW-XwzGl18qlgIYQZZOeqgCNcBGAsYHQ/s0/blank.png">
                </div>
                <div class="d-flex float-right">
                <div class="btn-group mr-2">
                <button type="button" class="btn btn-primary" data-method="rotate" data-option="-45" title="Rotate Left">
                <i class="fa fa-undo"></i>
                </button>
                <button type="button" class="btn btn-primary" data-method="rotate" data-option="45" title="Rotate Right">
                <i class="fa fa-redo"></i>
                </button>
                </div>
                <div class="btn-group mr-2">
                <button type="button" class="btn btn-primary" data-method="scaleX" data-option="-1" title="Flip Horizontal">
                <i class="fa fa-arrows-alt-h"></i>
                </button>
                <button type="button" class="btn btn-primary" data-method="scaleY" data-option="-1" title="Flip Vertical">
                <i class="fa fa-arrows-alt-v"></i>
                </button>
                </div>
                <button type="button" class="btn btn-primary" id="cropanh" data-method="getCroppedCanvas" data-dismiss="modal" data-option="{ &quot;width&quot;: 1000, &quot;height&quot;: 1000}">
                Cắt ảnh
                </button>
                </div>
                </div>
                </div>
                </div>
                </div>
                </div>
                </div>
                </div>
            </div>
<div class="mb-3">
    <button type="button" class="btn btn-primary disabled" id="tad-taoanh"><i class="fas fa-cut"></i> Xem trước</button>

</div>
    <img id="Cimg" style="display: none;" width="220" height="277"
        src="https://1.bp.blogspot.com/-z3RZ2G93tVo/YHES6yUdnzI/AAAAAAAArsw/Jq_pD24Pn-sEW-XwzGl18qlgIYQZZOeqgCNcBGAsYHQ/s0/blank.png"
        alt="The Scream">

Xem trước:

    <canvas id="temp" width="2000" height="2000" style="width:100%;border:1px solid #d3d3d3;">
        Your browser does not support the HTML canvas tag.</canvas>


        
        <div id="share-out"></div>
    <script>

var tyle= 1/1; vmode = 1;
var tenanhxuat = "cover_abstract";



        $("#tad-taoanh").click(function() {

            $("#cropanh").click();
    
            setTimeout(function(){   draw(); }, 200);


         

            
        });

function draw(){


                        var c = document.getElementById("temp");
                        var ctx = c.getContext("2d");

                        ctx.clearRect(0, 0, c.width, c.height);

                        var cimg = document.getElementById("Cimg");

                        ctx.save();
                        ctx.drawImage(cimg, 0, 0, c.width, c.height);
                        ctx.restore();
 

}


function shareLink(){


    var b = document.getElementById("temp").toDataURL("image/png").split(",")[1];

    $.ajax({
		url: "https://api.imgur.com/3/image",
		type: "POST",
		headers: {
			Authorization: "Client-ID 69ed3ac654c3326",
			Accept: "application/json"
		},
		dataType: "json",
		data: {
			image: b
		},
		success: function(c) {
			let t = JSON.stringify(c),
				n = JSON.parse(t);
			urlanh = n.data.link;
			let e = "https://taoanhdep.com" + location.pathname,
				s = $(".post-heading h1").text(),
				o = "<div class='mt-3'><div class='row'><div class='col pr-2'><a class='btn btn-block btn-outline-primary btn-sm mb-2' href='https://www.facebook.com/share.php?%20v=4&amp;src=bm&amp;u=" + urlanh + "&amp;t=" + s + "' rel='nofollow' target='_blank' title='Facebook Share'><i class='fab fa-facebook'></i> Chia sẻ ảnh</a></div><div class='col pl-2'><a class='btn btn-block btn-outline-danger btn-sm mb-2' href='https://pinterest.com/pin/create/button/?url=" + e + "&amp;media=" + urlanh + "&amp;description=" + s + "' rel='nofollow' target='_blank' title='Pinterest Share'><i class='fab fa-pinterest'></i> Lưu ảnh</a></div></div><div class='input-group mt-2'> <input class='form-control form-control-sm' type='text' value='" + urlanh + "' id='urlShare'><div class='input-group-append'> <button class='btn btn-primary btn-sm' type='button' onclick='tadShareCopy()'><i class='fas fa-copy'></i></button> </div></div> </div>";
			$("#share-out").html(o), $(".tad-shareimg").hide()
		},
		error: function(c) {
			console.log(c), alert("Lỗi tải ảnh lên")
		}
	})
            
}


    </script>


</body>

</html>