<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link as='style' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css'
        media='all' rel='stylesheet' />

    <script crossorigin='anonymous'
        integrity='sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=='
        src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js'></script>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" media="all">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" integrity="sha512-0SPWAwpC/17yYyZ/4HSllgaK7/gg9OlVozq8K7rf3J8LvCjYEEIfzzpnA2/SSjpGIunCSD18r3UhvDcu/xncWA==" crossorigin="anonymous" referrerpolicy="no-referrer">
</head>

<body class="col-md-6">

<script src="https://cdn.taoanhdep.com/tad/tv/cr-no.js"></script>


    <style>
        #chonanhModal {
            display: block !important
        }

        #chonanhModal:not(.show) {
            opacity: 0;
            visibility: hidden
        }

        .xulyhinhanh img {
            margin: 0 !important
        }

        .chonnen {
            max-height: 300px;
            overflow: auto
        }

        .chonanh-avt {
            width: 38px;
            height: 38px;
            float: left;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            margin-right: 10px
        }

        .img-preview {
            width: 36px;
            height: 36px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background: url(//2.bp.blogspot.com/-ZTMZs1MahXE/XqZq3WgQKDI/AAAAAAAAdRI/ib4MFhw49m82VLY9b2LzZBw5w3tItLSrQCK4BGAYYCw/s36/thumbnail-man.png)
        }

        .img-container,
        .img-preview {
            background-color: #f7f7f7;
            text-align: center;
            width: 100%
        }

        .img-container {
            margin-bottom: 1rem;
            max-height: 300px;
            min-height: 280px
        }

        .img-container>img {
            max-width: 100%
        }

        .img-preview {
            margin: auto !important;
            margin-bottom: .5rem;
            margin-right: .5rem;
            overflow: hidden
        }

        .img-preview>img {
            max-width: 100%
        }

        .chonnen .active .img-thumbnail {
            box-shadow: 0 0 0 .2rem rgba(38, 143, 255, .5)
        }

        img.tad-manhinh {
            position: absolute;
            top: 0;
            display: none;
            z-index: 9;
            left: 0;
            padding: 5px;
            width: 100%;
            border: 0;
            pointer-events: none
        }

        .chonnen .img-thumbnail {
            width: 100%;
            object-fit: cover;
            height: 100px;
            cursor: pointer;
            margin: 0
        }

        .chonnen>div {
            height: 100px;
            width: 100%
        }

        .chonanh-avt {
            width: 38px;
            height: 38px;
            float: left;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            margin-right: 10px
        }

        .catanh {
            height: 0;
            overflow: hidden;
            visibility: hidden
        }

        .catanh.showw {
            height: inherit;
            visibility: inherit
        }
    </style>

    <link href="https://cdn.taoanhdep.com/font/cover-studio/stylesheet.css" rel="stylesheet">
    <label><b>Chọn nền*</b></label>
    <div class="mb-3">
        <div class="chonanh-avt">
            <div class="img-preview"></div>
        </div>
        <button type="button" class="btn btn-primary btn-chonnen" data-toggle="modal" data-target="#chonanhModal"><i
                class="fas fa-image"></i> Chọn nền
        </button>
    </div>

<label>Chọn phông chữ</label>
    <div class="chonfont mb-2">
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="font1" name="font1" class="custom-control-input" checked="">
            <label class="custom-control-label" for="font1">Phông chữ 1</label>
        </div>
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="font2" name="font1" class="custom-control-input">
            <label class="custom-control-label" for="font2">Phông chữ 2</label>
        </div>

        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="font3" name="font1" class="custom-control-input">
            <label class="custom-control-label" for="font3">Phông chữ 3</label>
        </div>

    </div>

<label>Số dòng</label>
    <div class="chondong mb-2">
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="dong1" name="dong1" class="custom-control-input" checked="">
            <label class="custom-control-label" for="dong1">1 Dòng</label>
        </div>
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="dong2" name="dong1" class="custom-control-input">
            <label class="custom-control-label" for="dong2">2 Dòng</label>
        </div>

        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="dong3" name="dong1" class="custom-control-input">
            <label class="custom-control-label" for="dong3">3 Dòng</label>
        </div>

    </div>



    <label><b>Nhập tên*</b></label>
    <input class="form-control tad-in-text1 mb-2" aria-label="Nhập tên bạn" placeholder="Nhập tên bạn vào đây" value="Tạo ảnh đẹp">

    <input class="form-control tad-in-text2 mb-2" style="display:none" value="Frontend Developer - Graphic Design" aria-label="Nhập tên bạn" placeholder="Có thể để trống" value="">
 
    <input class="form-control tad-in-text3 mb-2" style="display:none"  value="https://facebook.com/tuan2308"; aria-label="Nhập tên bạn" placeholder="Có thể để trống" value="">
   
    <div class="custom-checkbox custom-control mt-2">
        <input type="checkbox" class="custom-control-input" id="phatsang">
        <label class="custom-control-label" for="phatsang">Chữ phát sáng</label>
    </div>
    <button type="button" class="btn btn-primary mt-3 disabled" id="tad-taoanh"><i class="fas fa-cut"></i> Tạo
        ảnh</button>
    <div id="img-out" style="position:relative" class="mt-2">
    </div>

    <div class="modal fade" id="chonanhModal" tabindex="-1" role="dialog" aria-labelledby="chonanhModalTitle"
        style="display:none" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="card-header modal-header" style=" padding: .75rem 1.25rem; ">
                    <ul class="nav nav-tabs card-header-tabs" id="myTab" role="tablist">
                        <li class="nav-item"> <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home"
                                role="tab" aria-controls="home" aria-selected="true">Chọn nền</a> </li>
                        <li class="nav-item"> <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile"
                                role="tab" aria-controls="profile" aria-selected="false">Tải ảnh lên</a> </li>
                    </ul><button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span
                            aria-hidden="true">×</span> </button>
                </div>
                <div class="modal-body">
                    <div style="clear:both"></div>
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                            <div class="chonnen row row-cols-2 row-cols-md-3"></div>
                        </div>
                        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                            <div id="actions">
                                <div class="docs-buttons">
                                    <label class="btn btn-primary btn-upload btn-upanh" for="inputImage"
                                        title="Upload image file">
                                        <input type="file" class="sr-only" id="inputImage" name="file"
                                            accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff">
                                        <span><i class='fas fa-upload'></i> Chọn ảnh</span>
                                    </label>
                                    <div class="cropanh-container mt-2" style="display:none">
                                        <div class="img-container">
                                            <img src="" alt="Tạo ảnh đẹp">
                                        </div>
                                        <div class="d-flex float-right">
                                            <div class="btn-group mr-2">
                                                <button type="button" class="btn btn-primary" data-method="rotate"
                                                    data-option="-45" title="Rotate Left">
                                                    <i class="fa fa-undo"></i>
                                                </button>
                                                <button type="button" class="btn btn-primary" data-method="rotate"
                                                    data-option="45" title="Rotate Right">
                                                    <i class="fa fa-redo"></i>
                                                </button>
                                            </div>
                                            <div class="btn-group mr-2">
                                                <button type="button" class="btn btn-primary" data-method="scaleX"
                                                    data-option="-1" title="Flip Horizontal">
                                                    <i class="fa fa-arrows-alt-h"></i>
                                                </button>
                                                <button type="button" class="btn btn-primary" data-method="scaleY"
                                                    data-option="-1" title="Flip Vertical">
                                                    <i class="fa fa-arrows-alt-v"></i>
                                                </button>
                                            </div>
                                            <button type="button" class="btn btn-primary" id="cropanh"
                                                data-method="getCroppedCanvas" data-dismiss="modal"
                                                data-option="{ &quot;width&quot;: 2000, &quot;height&quot;: 2000}">
                                                Cắt ảnh
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>


    <canvas id="temp" width="1500" height="1000" style="border:1px solid #d3d3d3;width: 100%;">
        Your browser does not support the canvas element.
    </canvas>

    <script>var tyle=3/2;var vmode=1;var tenanhxuat="anhbiahinhnen";
    </script>
    <script>



        var hinhnen = ["https://lh3.googleusercontent.com/-P_vZILSfuGM/YY2yL2F7qBI/AAAAAAAA0h4/y0Iw7umlSSgxKe_EAmqQLtG3PBq5eSY7wCNcBGAsYHQ/h240/1.jpg", "https://lh3.googleusercontent.com/-B_ERfdUoOhw/YY2yMxMA1ZI/AAAAAAAA0iA/vjclDTqcRFARWvHLgP8_aU_IpvMHpUOMwCNcBGAsYHQ/h240/2.jpg", "https://lh3.googleusercontent.com/-c5_QqqRUlWg/YY2yMyFo4VI/AAAAAAAA0iE/ssP6Gs43OtEP4mJq4drJW3gRXRmlDXcDwCNcBGAsYHQ/h240/3.jpg", "https://lh3.googleusercontent.com/-HJ_sSCh9xFc/YY2yNSORS4I/AAAAAAAA0iI/3gUPumgrocU3KG32anvTMNWDjqXqWBfNACNcBGAsYHQ/h240/4.jpg", "https://lh3.googleusercontent.com/--KSDPP-vvY4/YY2yNoy8h0I/AAAAAAAA0iM/X427z6P7bWojpIMOHLHWP1JxDMYZupLkACNcBGAsYHQ/h240/5.jpg", "https://lh3.googleusercontent.com/-Xn6iMu7PL1o/YY2yNtBFd6I/AAAAAAAA0iQ/VN8zLlnHrhcNIoaR4FsBePk3XFZHEAr7QCNcBGAsYHQ/h240/6.jpg", "https://lh3.googleusercontent.com/-cG5iRDjVDbQ/YY2yOEV3UeI/AAAAAAAA0iU/Ii6MAQWmEFkEl87NDwmfTioNcmkl9zVMwCNcBGAsYHQ/h240/7.jpg", "https://lh3.googleusercontent.com/-Atnv4HbuTDQ/YY2yOSDP3AI/AAAAAAAA0iY/mjykuQK46NQ04i2PcCfHUjwnwJ5VJ7LQwCNcBGAsYHQ/h240/8.jpg", "https://lh3.googleusercontent.com/-zPWweJ3iCz8/YY2yOUw6c4I/AAAAAAAA0ic/daAt7AzdFMkBSPwhjB-t3FbjYvU7wF1bQCNcBGAsYHQ/h240/9.jpg", "https://lh3.googleusercontent.com/-I_vh968aZG4/YY2yL8uX_eI/AAAAAAAA0hw/bC0qlEvwv5A1WTP1vp7jSQwubTU4M5jogCNcBGAsYHQ/h240/10.jpg", "https://lh3.googleusercontent.com/-GCcuV7URFYg/YY2yL5Go6EI/AAAAAAAA0h0/MYZTxwgdfVEPhpaBqUeM-KUHqUCvTl-3ACNcBGAsYHQ/h240/11.jpg", "https://lh3.googleusercontent.com/-fCT2rw0YWUw/YY2yMqf19nI/AAAAAAAA0h8/0P2qdVdJaEoN_XgzIIXbp7-B_GlJ4to3wCNcBGAsYHQ/h240/12.jpg"];

        $(document).ready(function() {


        function showlist() {
            $(".chonnen").html("");
            for (let i = 0; i < hinhnen.length; i++) {
                $(".chonnen").append("<div class='col mb-3 text-center'><img alt='Hình nền' class='img-thumbnail' src='" + hinhnen[i] + "'></div>");
            }
            $("#cropanh").click(function () {
                $(".dk1").val(1);
                $(".chonnen div").removeClass("active");
            });
            $(".chonnen div").click(function () {
                $(".btn-chonnen").html("<i class='fas fa-image'></i> Chọn nền khác")
                $(".dk1").val(1);
                $(".chonnen div").removeClass("active");
                $(this).addClass("active");
                var cropimg = $(this).children().attr("src").replace(/h240/g, "s0");
                coverBg = cropimg;
               
                $(".img-container img,.cropper-canvas img, .cropper-view-box img").attr("src", cropimg);
                $(".img-preview").css("background-image", "url(" + cropimg + ")").css("background-size", "cover").css("background-position", "center");
                $('#chonanhModal').modal('hide');
            });
        }

        $(".btn-chonnen").one("click", function () {
            showlist()
        });


var font = "SVN-Suargie";
var size = "200px";
var glow = false;
var dong = 1;
var coverBg = "";

$("#font1").click(function () {

font = "SVN-Suargie";
size = "200px"

});

$("#font2").click(function () {

font = "UTM Alpine KT";
size = "170px"

});
$("#font3").click(function () {

font = "SVN-Skill";
size = "220px"

});




$("#dong1").click(function () {

dong = 1

$(".tad-in-text2").hide();
$(".tad-in-text3").hide();
});

$("#dong2").click(function () {
dong = 2
$(".tad-in-text2").show();
$(".tad-in-text3").hide();
});

$("#dong3").click(function () {
dong = 3
$(".tad-in-text2").show();
$(".tad-in-text3").show();
});


var g = $(".tad-in-text1");
		var d = $(".tad-in-text2");
      var z = $(".tad-in-text3");
		g.on("input", function() {
			e()
		});
		d.on("input", function() {
			e()
		});
z.on("input", function() {
			e()
		});
function e() {

if(dong == 1){

if(g.val().length == 0){

$("#tad-taoanh").addClass("disabled")
}
else {
    $("#tad-taoanh").removeClass("disabled")
}
}



if(dong == 2){

if(g.val().length == 0 || d.val().length == 0){

$("#tad-taoanh").addClass("disabled")
}
else {
    $("#tad-taoanh").removeClass("disabled")
}
}


if(dong == 3){

if(g.val().length == 0 || d.val().length == 0 || z.val().length == 0){

$("#tad-taoanh").addClass("disabled")
}
else {
    $("#tad-taoanh").removeClass("disabled")
}
}


}

      




let isVisible = true;

$("#phatsang").click(function(){

    glow = isVisible;

    isVisible = !isVisible;

});



function draw(){


    document.fonts.load("10pt '" + font + "'").then(function () {
            document.fonts.load('10pt "Montserrat"').then(function () {


            var a = new Image();
            a.crossOrigin = "Anonymous";
            a.src = coverBg;
            a.onload = function () {

           

                var c = document.getElementById("temp");
                var ctx = c.getContext("2d");


                ctx.save();
                ctx.drawImage(a, 0, 0, c.width, c.height);
                ctx.restore();

                ctx.save();
                ctx.fillStyle = "rgba(34,34,34,0.5)"
                ctx.fillRect(0, 0, c.width, c.height)
                ctx.restore();

                var t1 = $(".tad-in-text1").val();
var t2 = $(".tad-in-text2").val();
var t3 = $(".tad-in-text3").val();




                var fontt1 = size +" "+ font;

ctx.save();

if(glow==true){

ctx.shadowBlur = 30;

ctx.shadowColor = "rgba(255,255,255, 0.8)";
}
                if (dong == 1) {
                    ctx.save();
                    ctx.fillStyle = "#fff";
                    ctx.textAlign = "center";
                    ctx.textBaseline = 'middle';
                    ctx.font = fontt1;
                    ctx.fillText(t1, c.width / 2, c.height / 2 + 50);
                    ctx.restore();
                }

                if (dong == 2) {
                    ctx.save();
                    ctx.fillStyle = "#fff";
                    ctx.textAlign = "center";
                    ctx.textBaseline = 'middle';
                    ctx.font = fontt1;
                    ctx.fillText(t1, c.width / 2, c.height / 2 + 30);
                    ctx.restore();

                    ctx.save();
                    ctx.fillStyle = "#fff";
                    ctx.textAlign = "center";
                    ctx.textBaseline = 'middle';
                    ctx.font = "50px Montserrat";
                    ctx.fillText(t2, c.width / 2, c.height / 2 + 120);
                    ctx.restore();

                }
                if (dong == 3) {
                ctx.save();
                ctx.fillStyle = "#fff";
                ctx.textAlign = "center";
                ctx.textBaseline = 'middle';
                ctx.font = fontt1;
                ctx.fillText(t1, c.width / 2, c.height / 2 + 10);
                ctx.restore();

                ctx.save();
                ctx.fillStyle = "#fff";
                ctx.textAlign = "center";
                ctx.textBaseline = 'middle';
                ctx.font = "50px Montserrat";
                ctx.fillText(t2, c.width / 2, c.height / 2 + 100);
                ctx.restore();

                ctx.save();
                ctx.fillStyle = "#fff";
                ctx.textAlign = "center";
                ctx.textBaseline = 'middle';
                ctx.font = "40px Montserrat";
                ctx.fillText(t3, c.width / 2, c.height / 2 + 170);
                ctx.restore();

                }


                ctx.restore();

            }
        }) })



}
  
  
  draw();


$("body").append('<input class="dk1 d-none" value="">')

  var dk1 = $(".dk1").val();

  $("#tad-taoanh").click(function(){

    if ($(".dk1").val() == "") {
				alert("Vui lòng chọn nền");
				showlist()
				$('#chonanhModal').modal('show');
				return false;
			}
          
            $("#img-out").hide();
			$("#tad-taoanh").addClass("disabled").html("<span class='spinner-border spinner-border-sm'></span> Đang tạo ảnh");

draw();

});
  

window.onload = function() {
			var j = window.Cropper;
			var h = window.URL || window.webkitURL;
			var c = document.querySelector(".img-container");
			var d = c.getElementsByTagName("img").item(0);
			var f = document.getElementById("actions");
			var k = {
				aspectRatio: tyle,
				viewMode: vmode,
				autoCrop: true,
				strict: true,
				background: true,
				autoCropArea: 1
			};
			var b = new j(d, k);
			var e = d.src;
			var a = "image/jpeg";
			var g;
			if (!document.createElement("canvas").getContext) {
				$('button[data-method="getCroppedCanvas"]').prop("disabled", true)
			}
			if (typeof document.createElement("cropper").style.transition === "undefined") {
				$('button[data-method="rotate"]').prop("disabled", true);
				$('button[data-method="scale"]').prop("disabled", true)
			}
			f.querySelector(".docs-buttons").onclick = function(n) {
				var r = n || window.event;
				var q = r.target || r.srcElement;
				var p;
				var l;
				var m;
				var o;
				if (!b) {
					return
				}
				while (q !== this) {
					if (q.getAttribute("data-method")) {
						break
					}
					q = q.parentNode
				}
				if (q === this || q.disabled || q.className.indexOf("disabled") > -1) {
					return
				}
				o = {
					method: q.getAttribute("data-method"),
					target: q.getAttribute("data-target"),
					option: q.getAttribute("data-option") || undefined,
					secondOption: q.getAttribute("data-second-option") || undefined
				};
				p = b.cropped;
				if (o.method) {
					if (typeof o.target !== "undefined") {
						m = document.querySelector(o.target);
						if (!q.hasAttribute("data-option") && o.target && m) {
							try {
								o.option = JSON.parse(m.value)
							} catch (r) {
								console.log(r.message)
							}
						}
					}
					switch (o.method) {
						case "rotate":
							if (p) {
								b.clear()
							}
							break;
						case "getCroppedCanvas":
							try {
								o.option = JSON.parse(o.option)
							} catch (r) {
								console.log(r.message)
							}
							if (a === "image/jpeg") {
								if (!o.option) {
									o.option = {}
								}
								o.option.fillColor = "#fff"
							}
							break
					}
					l = b[o.method](o.option, o.secondOption);
					switch (o.method) {
						case "rotate":
							if (p) {
								b.crop()
							}
							break;
						case "scaleX":
						case "scaleY":
							q.setAttribute("data-option", -o.option);
							break;
						case "getCroppedCanvas":
							if (l) {
								l.toBlob(function(blob) {
									var bloburl = URL.createObjectURL(blob);
									$(".img-preview").css("background-image", "url(" + bloburl + ")").css("background-size", "cover").css("background-position", "center");
                                    
                                   coverBg = bloburl;
                                    
                                });
							}
							break;
						case "destroy":
							b = null;
							if (g) {
								h.revokeObjectURL(g);
								g = "";
								d.src = e
							}
							break
					}
					if (typeof l === "object" && l !== b && m) {
						try {
							m.value = JSON.stringify(l)
						} catch (r) {
							console.log(r.message)
						}
					}
				}
			};
			document.body.onkeydown = function(l) {
				var m = l || window.event;
				if (!b || this.scrollTop > 300) {
					return
				}
				switch (m.keyCode) {
					case 37:
						m.preventDefault();
						b.move(-1, 0);
						break;
					case 38:
						m.preventDefault();
						b.move(0, -1);
						break;
					case 39:
						m.preventDefault();
						b.move(1, 0);
						break;
					case 40:
						m.preventDefault();
						b.move(0, 1);
						break
				}
			};
			$(".cropanh-container").hide();
			var i = document.getElementById("inputImage");
			if (h) {
				i.onchange = function() {
					var m = this.files;
					var l;
					if (b && m && m.length) {
						l = m[0];
						if (/^image\/\w+/.test(l.type)) {
							a = l.type;
							if (g) {
								h.revokeObjectURL(g)
							}
							d.src = g = h.createObjectURL(l);
							b.destroy();
							b = new j(d, k);
							i.value = null;
							$(".cropanh-container").show();
							$(".btn-upanh span,.btn-chonanh").html("<i class='fas fa-upload'></i> Chọn ảnh khác");
                            $(".dk1").val(1);
						} else {
							window.alert("Vui lòng chọn một tệp hình ảnh.")
						}
					}
				}
			} else {
				i.disabled = true;
				i.parentNode.className += " disabled"
			}
		};
        })
  </script>



</body>

</html>