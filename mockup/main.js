var tvtad="";$(document).ready(function(){if(window.location.hostname==tmbq){$("#tad-taianhve").hide();$(".tad-ketqua").hide();$("#tad-taoanh").click(function(){$(".load-anh").fadeIn(500,function(){e()})});var b=document.getElementById("Cimg");var d=document.getElementById("Limg");var a=document.getElementById("Nimg");b.crossOrigin="Anonymous";b.src="https://1.bp.blogspot.com/-z3RZ2G93tVo/YHES6yUdnzI/AAAAAAAArsw/Jq_pD24Pn-sEW-XwzGl18qlgIYQZZOeqgCNcBGAsYHQ/s0/blank.png";function e(){c=document.querySelector("canvas"),ctx=c.getContext("2d"),corners=vitri,step=1;g();function g(){var r,q,p,n,s,l,k,i,o=b.width-1,j=b.height-1;ctx.clearRect(0,0,c.width,c.height);for(y=0;y<j;y+=step){for(x=0;x<o;x+=step){s=f(corners[0],corners[3],y/j);l=f(corners[1],corners[2],y/j);k=f(corners[0],corners[3],(y+step)/j);i=f(corners[1],corners[2],(y+step)/j);r=f(s,l,x/o);q=f(s,l,(x+step)/o);p=f(k,i,(x+step)/o);n=f(k,i,x/o);ctx.drawImage(b,x,y,step,step,r.x,r.y,Math.ceil(Math.max(step,Math.abs(q.x-r.x),Math.abs(n.x-p.x)))+1,Math.ceil(Math.max(step,Math.abs(r.y-n.y),Math.abs(q.y-p.y)))+1)}}ctx.save();ctx.drawImage(d,0,0);ctx.restore();if(a){ctx.save();ctx.globalAlpha=0.8;var m=ctx.createPattern(a,"repeat");ctx.fillStyle=m;ctx.fillRect(0,0,c.width,c.height);ctx.restore()}c.toBlob(function(h){var t=URL.createObjectURL(h);$("#img-out").html("<img src='"+t+"' alt='Tạo ảnh đẹp' class='img-thumbnail'></img>");$("#tad-taianhve").attr("download",tenanhxuat).attr("href",t)});$("#tad-taianhve").show();$(".tad-ketqua").show();$(".load-anh").fadeOut(500)}function f(j,i,h){return{x:j.x+(i.x-j.x)*h,y:j.y+(i.y-j.y)*h}}}}});