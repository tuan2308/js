var tvtad="";$(document).ready(function(){if(window.location.hostname==tmbq){$("#tad-taianhve").hide();$(".tad-ketqua").hide();$("#tad-taoanh").click(function(){$(".load-anh").fadeIn(500,function(){d()})});var j=document.getElementById("Cimg");var b=document.getElementById("Bimg");var a=document.getElementById("Limg");var e=document.getElementById("Nimg");function d(){c=document.querySelector("canvas"),ctx=c.getContext("2d"),corners=[{x:-20,y:155},{x:1160,y:276},{x:1107,y:865},{x:68,y:1029}],corners1=[{x:1893,y:326},{x:1222,y:280},{x:1173,y:850},{x:1821,y:694}],step=1;g();function g(){var n,m,r,p,h,o,l,i,q=j.width-1,k=j.height-1;ctx.clearRect(0,0,c.width,c.height);ctx.save();ctx.drawImage(b,0,0,c.width,c.height);for(y=0;y<k;y+=step){for(x=0;x<q;x+=step){h=f(corners[0],corners[3],y/k);o=f(corners[1],corners[2],y/k);l=f(corners[0],corners[3],(y+step)/k);i=f(corners[1],corners[2],(y+step)/k);n=f(h,o,x/q);m=f(h,o,(x+step)/q);r=f(l,i,(x+step)/q);p=f(l,i,x/q);ctx.drawImage(j,x,y,step,step,n.x,n.y,Math.ceil(Math.max(step,Math.abs(m.x-n.x),Math.abs(p.x-r.x)))+1,Math.ceil(Math.max(step,Math.abs(n.y-p.y),Math.abs(m.y-r.y)))+1)}}for(y=0;y<k;y+=step){for(x=0;x<q;x+=step){h=f(corners1[0],corners1[3],y/k);o=f(corners1[1],corners1[2],y/k);l=f(corners1[0],corners1[3],(y+step)/k);i=f(corners1[1],corners1[2],(y+step)/k);n=f(h,o,x/q);m=f(h,o,(x+step)/q);r=f(l,i,(x+step)/q);p=f(l,i,x/q);ctx.drawImage(j,x,y,step,step,n.x,n.y,Math.ceil(Math.max(step,Math.abs(m.x-n.x),Math.abs(p.x-r.x)))+1,Math.ceil(Math.max(step,Math.abs(n.y-p.y),Math.abs(m.y-r.y)))+1)}}ctx.save();ctx.globalAlpha=0.8;ctx.drawImage(e,0,0,c.width,c.height);ctx.restore();ctx.save();ctx.drawImage(a,0,0,c.width,c.height);ctx.restore();c.toBlob(function(s){var t=URL.createObjectURL(s);$("#img-out").html("<img src='"+t+"' alt='Tạo ảnh đẹp' class='img-thumbnail'></img>");$("#tad-taianhve").attr("download",tenanhxuat).attr("href",t)});$("#tad-taianhve").show();$(".tad-ketqua").show();$(".load-anh").fadeOut(500)}function f(l,i,h){return{x:l.x+(i.x-l.x)*h,y:l.y+(i.y-l.y)*h}}}}});